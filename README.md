# Bricks

Сервис для ведения учёта положенных в доме кирпичей. 
Сделан с помощью Django, тесты лежат в /bricks_api/tests/

# Сущности:
**Дом - House**<br/><br/>
address - CharField - максимальная длина 255, уникальное поле<br/>
date_start - DateField - дата создания обьекта(начала строительства объекта)<br/>
date_completed - DateField - дата завершения строительства( когда количество заказанных кирпичей на  данный момент сравнится с количеством кирпичей необходимым для завершения строительства становится равным date_last_load), дефолтное значение None<br/>
date_last_load - DateField - дата последней доставки кирпичей, дефолтное значение None<br/>
bricks_at_the_moment - IntegerField - количество заказанных кирпичей на данный момент, дефолтное значение 0<br/>
total_bricks_required - IntegerField - количество кирпичей необходимое для завершения строительства. Минимальное значение 1<br/>
date_updated - DateField - дата последнего обновления объекта<br/>
Обязательные поля при создании объекта - address, total_bricks_required<br/><br/>
**Задание на кладку кирпичей - Brick_Task**<br/><br/>
bricks - IntegerField - количество заказанных кирпичей, которые пойдут на строительство. Минимальное значение 1. Если количество кирпичей + bricks_at_the_moment соответствующего здания превысит total_bricks_required, в поле запишутся только то количество кирпичей, которое пойдет на завершение, оставшиеся (лишние) кирпичи пойдут в excessive_bricks<br/>
house_id - ForeignKey - ключ на сущность дома<br/>
date_load -  DateField - дата выгрузки кирпичей<br/>
excessive_bricks - IntegerField - лишние кирпичи<br/>
Обязательные поля при создании объекта - bricks, house_id, date_load<br/><br/>
# Методы:
<br/>**POST /building/ - создать дом**<br/>
Необходимые параметры: address, total_bricks_required <br/>
Пример: {"address": "дом 50 улица Ленина", "total_bricks_required": 300}<br/><br/>
**POST /building/{id}/add-bricks/ - создать задание на кладку кирпичей**<br/>
id - id дома куда пойдут кирпичи, если дома нет, задание не создастся<br/>
Если дом уже построен - задание не создастся<br/>
Если date_load меньше date_start - задание не создастся.<br/>
Вместе с созданием задания кладки кирпичей, обновляет соответствующий дом.<br/> 
Обновляются поля:<br/> 
date_completed - при завершении строительства<br/>
date_last_load - если дата выгрузки позже чем дата предшествующей наиболее поздней выгрузки<br/>
bricks_at_the_moment - увеличивается на bricks<br/>
date_updated - проставляется дата изменения объекта<br/>
Необходимые параметры: bricks, date_load<br/>
Пример: {"bricks": 200, "date_load": "2030-03-10"}<br/><br/>
**GET /stats/ - выводит адрес, дату и сколько кирпичей заказано на данный момент с группировкой по дате.**<br/>
Предположим для одного дома в день 1 - должны привести 2 кирпича<br/>
В день 2 - еще 3 кирпича<br/>
В день 3 - две выгрузки по 4 кирпича.<br/>
Запрос выведет нарастающий итог как<br/>
[ { "house_id__address": "Дом 1",  "date_load": "2050-06-01", "bricks_sum": 2 },
{ "house_id__address": "Дом 1",  "date_load": "2050-06-02", "bricks_sum": 5 },
{ "house_id__address": "Дом 1",  "date_load": "2050-06-03", "bricks_sum": 13}]
